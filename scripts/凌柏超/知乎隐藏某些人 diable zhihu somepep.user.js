// ==UserScript==
// @name         知乎隐藏某些人 diable zhihu somepep
// @namespace    http://tampermonkey.net/
// @version      0.51
// @description  知乎隐藏某些人
// @require      https://cdn.bootcss.com/es6-shim/0.35.5/es6-shim.min.js
// @require      https://cdn.bootcss.com/gator/1.2.4/gator.min.js
// @author       You
// @license      996
// @match        https://www.zhihu.com/question/*
// @grant        none
// ==/UserScript==

!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t){var n,r,o,i,c,l="pingbi",a={stringify:function(e){var t={};for(var n in e)t[n]={type:Object.prototype.toString.call(e[n]).split(/\W/)[2],value:e[n].toString()};return JSON.stringify(t)},parse:function(e){var t={},n=JSON.parse(e);for(var r in n)if("RegExp"==n[r].type){var o=n[r].value.match(/\/(.*)\/([a-z]+)?/);t[r]=new RegExp(o[1],o[2])}else"String"==n[r].type?t[r]=n[r].value:"Function"==n[r].type&&(t[r]=new Function("return ("+n[r].value+")")());return t}};function u(){console.log("saveCache pingbi",n);var e={};for(var t in n)e[t]=n[t];window.localStorage.setItem(l,a.stringify(e))}function d(){s(),u()}function s(){var e;if(e=n.map(function(e,t){return function(e,t){var r=document.createElement("div"),o=document.createElement("span"),i=document.createElement("span");return i.textContent="x",i.onclick=function(){n.splice(t,1),r.parentNode&&r.parentNode.removeChild(r),u()},i.style.cssText="\n    margin-left: 10px;\n    cursor: pointer;\n    ",o.textContent=e,r.appendChild(o),r.appendChild(i),r}(e,t)}),r.children.length>1){var t=r.children[1];t.innerHTML="",e.forEach(function(e){t.appendChild(e)})}}function f(e){var t=e.querySelector(".RichContent");if(t.style.display="none",!e.querySelector(".AuthorInfo-head button")){var n=function(e){var t=document.createElement("button");return t.innerHTML="toggle",t.classList.add("Button"),t._showed=!1,t.style.cssText="\n    margin-left: 10px;\n    ",t.addEventListener("click",function(){console.log("click"),t._showed?(t._showed=!1,e.style.display="none"):(t._showed=!0,e.style.display=null)}),t}(t);e.querySelector(".AuthorInfo-head").appendChild(n)}}function p(){var e=document.querySelectorAll(".AnswerItem");e&&Array.prototype.slice.call(e).filter(function(e){var t=!1,r=e.querySelector(".AuthorInfo-head .UserLink-link");return r?(t=n.some(function(e){return e.test?e.test(r.textContent.trim()):e===r.textContent}),console.log(r.textContent,t)):n.indexOf("~")>-1&&(t=!0),t?f(e):r&&function(e,t){if(!e.querySelector(".AuthorInfo-head .filter")){var n=document.createElement("div");n.classList.add("filter"),n.textContent="添加到过滤",n.style.cssText="\n        cursor: pointer;\n        border: 1px solid #ddd;\n        padding: 10px;\n        margin-left: 10px;\n        border-radius: 3px;\n        ",n.onclick=function(){window.concatPingBi([t.textContent])},e.querySelector(".AuthorInfo-head").appendChild(n)}}(e,r),!0})}window.setPingBi=function(e){n=e,d()},window.concatPingBi=function(e){n=n.concat(e),d()},c=window.localStorage.getItem(l),n=c?(o=c,(i=a.parse(o)).length=Object.keys(i).length,Array.from(i)):[],function(){var e=document.createElement("div");e.textContent="屏蔽规则";var t=document.createElement("div");(r=document.createElement("div")).appendChild(e),r.appendChild(t),r.style.cssText="\nposition: fixed;\nright: 0;\ntop: 50%;\ntransform: translateY(-50%);\npadding: 30px 10px;\n",document.body.appendChild(r),s()}(),function e(){setTimeout(function(){var t=document.querySelector("#QuestionAnswers-answers > .Card > .ListShortcut > .List");if(t){var n=t.children[1];new MutationObserver(function(e){var t=!0,n=!1,r=void 0;try{for(var o,i=e[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var c=o.value;"childList"==c.type&&(c.addedNodes&&c.addedNodes.length>0||c.removedNodes&&c.removedNodes.length>0)&&p()}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}}).observe(n,{attributes:!1,childList:!0,subtree:!0}),p()}else setTimeout(function(){e()},3e3)},300)}(),window.Gator(document).on("click","button[role=option]",function(){console.log("click"),setTimeout(function(){p()},1e3)})}]);